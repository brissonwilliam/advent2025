static INPUT: &str = "
@@@@@..@@@@@@@@..@@@@.@@.@.@@.@@@@@@@.@@.@..@@@@..@@@..@.@@..@@@@.@......@@@..@@@@.@@@@@@@@.@@@@@.@@@@@@@@.@.@@..@.@@@@@@@@@@.@..@..@@..@.@
@.@..@@.@..@@@@.@..@@@..@@....@.@.@...@.@@..@.@@.@@@@.@@.@@@..@..@.@.@..@@@@@.@@@.@@@..@@.@@@@.@@.@..@.@@@@@@@.@@...@@@@.@@.@@@@@@@@@@..@.@
@..@@@@@.@.@@.@.@.@@@@@...@.@@.@.@@@@@.@@.@@...@@@...@@@@@@@@@@@@@@.@.@@.@.@@@..@.@@.@@@@..@@.@.@.@@@@@@@@@.@.@@@@..@.@@@@@@@@.@@@@@@.@@@..
@@@.@@@@.@.@@@@...@@..@@@.@.@@@.@.@.@@..@.@@@@@@@@@@@.@@.@@@.@@.@@@@@@@@@@@@..@..@@@..@@@.@.@@..@@.@.@..@.@@@@.@@@@@.@@.@@@.@@@@@..@@..@...
@@@@..@.@...@@.@.@@..@@@@.@@@@@@....@@..@@@.@@@@@@@@......@@@@@@.@@...@@.@@.@@@@@.@@..@@.@@.@@@.@@@@@@@@...@@@@.@.@@.@..@..@@@.@...@@.@...@
@..@@@@@..@@.@.@@..@@@.@@.@@@@@@...@@@@@..@@.@@@@@..@.@...@@@..@@.@@@@.@@....@@@@@@@@@@@@.@@@.@@@@..@@@@.@..@@@@@@.@.@...@..@.@..@.@@.@@.@@
.@..@@@@@..@@.@@@@@@@@.@@@.@@@.@.@...@..@@@.@.@@@.@@.@.@..@.@@..@@..@.@.@@@@..@.@@@@@@@@@@@@.@..@...@.@@@@@@@@@.@@...@@@.@.@@@..@@@.@@@@@@@
@@@@.@@@@.@..@.@.@..@..@@.@@@@@@.@......@@@..@@@.@@@.@.@@@@..@@@.@@@..@@@@@..@@@@.@@@@@..@@.@.@@@@@..@@@.@@.@@@@@.@.@@.@@..@@@..@.@.@.@@.@@
@@@@@@@@.@..@@@@.@.@@..@.@.@@@@@....@.@@@..@@.@@@@@..@@....@@.@.@@@@@@@.@@@@@@@@.@@.@..@.@@@..@.@@@.@@..@@@.@@@@@@@@@@.@.@@@@..@@@@@@@@.@@@
.@.@@...@.@.@@@@@.@@@@@@@...@..@@@@@.@.@@@@@@@@@.@@..@.@@.@@@..@@@.@@@.@@@.@.@@.@@@@@@@@@@..@.@@@@@@@@@@@.@@@....@@.@.@@@@.@@..@@@@@@.@@@@@
@@@@..@..@.@@.@@@@.@.@@@@@@@@@@@.@@@....@@.@@@@.@..@@..@@.@@@@.@.@.@@.@@@.@.@@@@.@.@@@@@.@@@..@.@@@@@@..@...@@@@..@@@@@@@.@@@@@@@@@.@.@@@@@
...@@@@@@@@.@@@@...@@.@..@@@@@@@@@.@@@.@@@@.@@.@@....@@...@@@.@.@.@@@@@@@@@@.@@.@.@.@@@.@@..@@..@@.@.@.@.@.@.@@@@.@..@.@..@@@@.@.@@@@@.@@@.
@@@...@@@@@..@.@.@...@@..@.@@@@..@@@@...@@@@.@@@@@.@@@@.@@@@@..@.@@@@@.@@@@.@@@.@@@@..@@@@@..@.@@@...@@...@@@@@@@@.@.@@@..@@.@@@.....@@.@@@
.@@@@@.@@@@@@@..@@.@@@@@@@@@@.@@.@@.@@@@@.@@@@@..@@@@@@@@@..@@@@@@@@@.@@@..@.@.@@....@@..@..@.@@@.@@@@@@...@@@@@@@@@@@.@.@@..@.@@.@@@@.@@..
..@@@@@@@@@@.@.@@@@@@.@..@@.@.@@@@@@@@.@.@@@@@@@@.@.@@@.@@@@.@@@..@@..@@@@@.@@@.@@@@@@.@@@..@@@@@...@@@.@@@.@.@@...@@.@@@.@@@@@@@@@@@@@@@@@
@@.@..@@@.@@@.@@@@@@@@@@@..@..@.@@.@@@.@@@@@@@.@..@..@@@..@@@...@..@@@@@...@@.@@@@@@@@...@@..@@.@@@@....@@@@.....@.@...@@@..@@@@.@@@.@@@@@@
@@..@@.@@@.@@@@..@.@@@.@@.@@@@@@.@..@@@@@...@@@@@@@..@.....@@.@@.@..@@@..@@@@.@@@..@.@.@@@@.@@@@@@@@@@@@@@@@.@@.@.@.@@@@.@@..@.@@...@..@.@@
@@@.@@@@@@@@@@.@@@@.@@@@@@@@.@@@@@.@@@.@@..@.@@..@@@@@..@.@.....@.@@@@@..@.@@@.@@@@.@..@..@..@@@...@@@@..@.@.@@@@.@...@@@@@@@...@..@@.@@.@.
@.@@...@@.@@@@@@@..@.@.@@@..@@.@.@@@@...@.@@@@@@@@@@@@@@@..@@@@.@@....@@@@@...@@.@@.@@@@@@.@@.@@.@@.@@.@@.@@@.@.@.@@@@.@@.@.@@..@@..@.@@@@@
@@@@.@.@.@@@@@@@..@@@@@..@@.@.@@@.@@@.@.@@@@@@@@@@@@@@@@@...@@@....@.@.@@@@@@.@....@..@@.@@@@@..@@.@@@@@.@@@@.@@@@@..@@@@@.@@@@.@.@.@@@..@.
@@@.@@.@@@.@@@@.@@.@@@.@..@@.@..@@@@@.....@.@@.@.@@.@@.@@@.@.@@@.@@.@@@@..@..@@@..@@@@@.@....@@..@.@@@@@.@.@@@@..@@@@@@@@.@@....@@.@@.@@@..
.@@.@@.@@..@@@.@@@@@@@.@@@.@@@@@@@..@@.@@@.@@@@.@@.@..@@@.@@.....@.@@...@@.@.@@.@@@@@@@@.@@..@@@.@.@.@@.@@@@@@@.@..@@@@.@@@@@@@@..@..@@.@..
@@@...@@@.@@@@.@.@@.@@..@@@@@@@@@@@@.@.@@.@..@@@@@.@@@...@@@.@@.@.@.@......@@.@@.@.@@@.@@@@@..@@.@.@@..@@@@@@@.@@@..@..@@...@@@@@@@@@@@@@.@
@@@@.@....@@@@@@@@@@@..@@..@.@@..@@@@.@@@@@.@.@@@.@.@@.@@@@@@@@.@...@@.@@.@@@.@@@.@..@@.@@.@@..@@.@...@@@.@.@@@...@@@.@@@@@@@@.@.@@.@..@@@@
@@@@.@.@.@@@@@@@@.@@@@@.@.@.@.@.@@.@@@.@@@.....@@.@.@.@@@.....@@..@.@@@@@.@...@@@@@@.@@@.@.@..@@.@@@@@...@@@@.@.@.@..@@@..@@@@@@.@@.@@@.@..
..@@@.@.@@@@@@@@..@@@..@@@@@@@@@@.@.@@@@@@@@@..@@@@...@@@@.@..@@..@@@@.@@@@.@@@.@@.@@@@....@.@.@..@.@.@@..@@.@@@@@@.@...@@.@@@.@..@@@@.@.@@
..@@@@@.@.@@@.@@..@.@..@.@@@@@@@@@.@...@..@@@@@.@@@@@.@...@@....@@@@@.@.@@.@.@.@.@.@.@@@@@@...@@..@...@@@@.@@@@.@.@..@.@@@@@@@@@@.@@@@.@.@@
.@@@@@..@@@@.@@@@@..@@@.@@.@..@...@@@..@@@@@.@@.@@..@@@.@@..@@...@@@.@.@...@@.@@@@@..@@@@@.@@@@@@.@.@@@@.@.@.@.@@@@@.@@@@...@@@@@.@@@@@@.@.
@@@.@@..@...@@@@@@..@@@@@@@...@@@@@@@@......@@.@@.@@.@.@.@.@@..@@..@@.@.@.@@.@@@.@@@@@@@@@@@.@@.@@..@@@@...@@@@@@@@.@.@@@.@.@@@..@@@@@@...@
@..@@..@@@@@.@@@@.@.@@@.@..@.@.@.@.@@@.....@@@.@.@.@@.@@.@@..@@@@@@@@@...@@....@.@.@@@..@@..@@@@@...@@@@@@@@@@@@@@@@@@@.@...@@@@..@.@.@@@@@
@@..@.@@@.@@@..@.@@.@@@@@@..@@.@..@@@@@@.@@@.@@@...@@.@.@@@@.@.@@@@@..@@@@@@.@@@@.@.@@@@@@@@@@..@@.@@.@@.@@@.@.@@@..@@.@@.@@.@.@@@@@@@..@..
@..@@.@..@@@@@@@.@.@...@.@@@@@@.@@@@@....@@@@@....@@@.@@..@@@@..@@@.@.@@@@@@@@.@..@@@@@..@@@@@@@@.@@@.@@@@@@@@.@@@@.@@..@@...@@@@@.@@@.@@@.
@@@@@@@..@@@.@..@.@..@@.@.@@@@.@@@@.....@@.@.@@@.@@..@@.@@@.@..@@.@.@@.@.@.@@.@@@.@@.@@.@@@@@.@..@@.@...@@.@..@@@@@@@@@..@@@@@.@@.@@..@.@.@
@.@@@.@.@.@@.@@@@.@@....@@@@@.@@@..@..@@....@.@@@@@@..@@@.@@@@@@..@.@.@@@....@.@...@@@.@@@@@.@.@.@@@@@..@@@.@.@@..@@.@.@.@@@@@@.@.@..@@.@.@
.@@..@@.@.@@@@@.@@.@..@@.@@.@@@@@@@@...@.@@@@@@..@@@@@.@@.@.......@@.@@@@@@.@.@.@.@@@.@.@@@.@..@.@@@@...@@@@.@@..@..@@@@@.@@@@@.@@@@@@@@@@@
@@@@@@@@@.@...@@..@.@@@@@.@@@..@@@@@..@@@@.@.@.@.@@@@@@@@@@@@.@...@.@@@@@.@@.@@@@@@.@@@@@@@.@..@@@@.@.@@@@@@@@..@.@@@@@@@.@@.@@..@@@@@@@@@@
@@@...@@@@@@@.@@@@@@..@.@@@.@@@.@..@@.@@.@@.@@.@.@@.@.@@@..@@@@@....@@@@.@..@@...@@@@@@.@.@@.@@@..@.@.@.@@@@.@@@...@@@@@@.@@@..@.@@.@@.....
@@.@@@@@.@.@@@@...@@@@@@@.@.@@....@@.@.@@.@...@@.@@@@@@......@.@@@@@...@.@...@@@@@@@.@@..@@@.@@@@@.@.@@.@@@@..@@.@.@@@@@@.@@...@@..@@@@@.@@
@@@.@@@.@@..@@@@....@.@.@.@.@@@@.@..@@@@.@@@@@@@@@@..@.....@.@@.@@@.@@@@@@.@.@@.@@.@.@@@@@.@@@@@@@..@@@@@.@...@@@..@....@.@@@.@@.....@..@.@
@@@.@@.@@@@..@@@.@.@@.@..@@@@.@@.@@@.@@.@@.@@@..@@.@..@@@.@.@@@@..@.@@@@@.@..@@.@.@@@@@@.@@@@@.@.@@.@@@@.@@@..@.@@.@@.@.@..@@@.@.@@@.@@.@@@
@.@@@@@@@@..@@@@@@@@@@..@@@@.@@....@.@...@@@@....@@@@.@@@@.@@@@@@.@@.@..@.@@@@@.@.@@@@@..@@.@@..@@@.@@.@.@@.....@@@..@@@@..@@@@@.@@.@@@@..@
..@@@@@@@@@.@@@.@@@@@.@@@..@.@...@........@@@.@@.@@@@@...@.@.@@.@..@..@@@.@.@...@@@.@.@@.@..@@@@..@@@@.@......@@.@@..@.@@..@@@..@.....@@@.@
.@@@@..@.@@.@@@.@@@@@@@.@@@..@@..@@@.@..@..@@@.....@@.@@@@@@@@.@.@.@.@@@@@@..@@@@@@.@@.....@.@..@@..@@..@@@.@@@@.@@@.@@.@@@.@.@@..@@.@@@..@
.@@@@@@@@@@@@@.@@@@.@..@@.@..@@.@@.@.@@.@@@@@@@.@@.@@@...@@@.@@..@@..@.@..@@@@@@@@@@@@.....@@@@@@@@@@@@.@@.@@.@@@.@@.@....@@@...@@.@.@@.@@.
.@....@@@@@@@@@@..@@.@@@@..@@@@@.@@@@@@..@...@.@.....@@@@@@...@@.@@.....@@@@@@@.@@@@.@@.@.@@@.@@.@@@@@@@@@..@@.@.@@@.@@@.@@@@.@@.@.@..@.@.@
@@@@.@@.@..@@.@@@@@@@..@.@.@..@..@@@.@@@@@@@.@.@.@@@..@@@@@@.@@@.@.@..@@@@@@@@@....@@.@@@@@@..@@@..@.@@@@@..@@....@@@@@@.@..@@@...@.@.@..@@
@@.@@@@...@@.@.@@.@@@.@@@@@....@@@@@@.@@.@..@.@.@@.@@@@.@.@@@@@@..@@@...@@@@@@@....@.@@@@.@@@@@.@@@.@@..@@.@.@..@@@@@@@.@..@@@@@@@@..@@.@@@
.@@@@.@@@@.@.@...@.@@@..@..@@@@@@@@.@.@..@.@..@@@@@.@..@@@@@@.@@@@@@@.@@@.@@@...@.@.@@@@@@.@@@...@.@..@@@@@.@..@..@.@..@@@@@@@@@@.@@@.@.@@.
@...@.@@@@@.@@@@@..@@.@@@.@@@@@..@@@@@@@@@@@...@@@@@@.....@@.@.@.@@@@@@@@..@@@@@@@@@@@@.@.....@@.@..@@@@.@...@@@@@@@@...@@@.@@@@.@@@@@@@...
.@.@..........@...@....@...@@.@@@@@@@.@@.@...@@.@..@@..@@@..@@@@...@@...@@@..@@..@@@@@.@@@@@@@.@...@@@@@@@@@@..@..@@@@@@.@.@@@@..@.@@@@@.@.
@@.@@@@.@@.@@@@.@@.@@@@.@@@.@.@@.@@@@@.@@@.@..@@@@@.@@@..@@..@@.@.@@...@@@....@@..@@..@.@@@...@@@@.@@...@..@@@@@..@@@@@@.@@.@.@@..@@.@.@@@@
@@@@@....@....@@.@..@@@@...@...@@.@.@@@..@@@@.@..@.@@@@.@@@@..@.@.@.@@@@@..@@@@.@@....@.@.@.@..@..@@.@..@@@@@.@@@.@@@@@@@@.@@@@@@.@@@@.@@.@
@.@....@..@@@@@@@.@@@.@.@@@@@.@.@@@.@@@@@@@@.@@@.@@@.@@@@.@.@..@.@@@@@@..@@.@..@@@.@.@@@@.@@@.@@@@..@@@@.@@@@@..@@@.@..@@@@.@.@@@@.@@@.@...
..@@@@@@@@...@@@@.@@.@@@..@@@@..@@.@@.@..@......@...@@....@@.@@@@@@.@@@@@@@@@@@..@@@.@.@@@@.@..@@.@.@@.@..@.@@@@@..@..@@@@@@.@.@.@.@@.@@@@@
@.@....@.@@...@@@@@@.@@@@@.@@@@@@@@.@.@...@.@.@@@.@@@@@@......@...@.@@..@@.@@@@.....@@@@@@@...@@...@@@.@@.@@@@@@@@@@@@@.@@@@@@@.@@@@@@.@@@@
@@@@.@@@@@@..@@.@@..@@.@..@.@..@@@@@@@@@@@....@.......@..@.@@.@@.@@@@@@@@@@.@@@@@@@..@..@@.@@@.@@.@.@@.@...@..@..@@@.@.@@@..@@@.@..@.@@@.@@
@@@.@@.@@@..@@@.@@.@@.@@.@@@@@@@@@.@.@.@@@.@@.@@@...@@.@@....@@@@.@@..@@@@@@.@@@.@@@@@.@@....@@@@@@.@...@@.@.@@@.@@@@.@@@@...@@@@@@@.@@.@@@
@.@@@@..@.@...@@@@@@@@@..@@@@@@@@@@@.@..@@@@@.@....@.@.@@@.@@.@...@.@.@@@@...@@@...@..@@@@@@@@@.@.@@..@@@@@@.@@.@...@@..@@.@@.@@@.@..@.@.@@
.@@@.@.@@...@.@@@@@@@@@@.@@@@.@.@.@@@@@.@.@@@@@@@@@@@.@.@@@@@@@@@.@...@@@@.@@@@@.@...@@.@@.@@@@..@@@@@@@.@@@..@@@.@@.@@@@@.@@@@@@.@@@@@@..@
@.@@.@@.@@@.@@@@@@.@@.@@.@.@@@.@@..@@.@.@@@@@.@@@@....@.@...@@@@.@.@..@@@.@@@.@.@.@.@.@...@.@@.@@@@.@@.@@..@.@@@@@@@.@.@..@.@@.@.@.@@.@@@@.
.@@..@..@@@@@@@@.@@@@@.@.@.@.@@@@@....@@..@@.@.@.@@@@@@.@..@..@.@@..@@@@@@.@..@.@@.@@@.@..@..@.@@.@@@@@@@.@@.@@@@.@..@.@@.@@@.@@.@@@.@.@..@
.@@.@@@.@@....@@..@.@.@.@@@..@.@@@.@@@@@@.@@@@.@@@.@@.@@...@.@.@@@@@@..@..@.@.@@@@@@@@@...@@@..@.@..@..@@.@@@..@..@@@.@.@@@@@...@@@@@@@@@.@
@@.@..@@@.@@...@@@@@..@@....@@@@@@@@@.@.@@@@.@...@.@@@..@@@@@@@@..@@@.@@..@.@@@..@@@@.@@@..@@@.....@...@.@.@..@.@.@@@@...@@@@.@@@@.@.@@@..@
@@@@@.@@..@@@@.@@.@@.@.@@@@.@.@@@@@@.@@..@@..@@@...@.@@@@....@@.@.@..@.@@@...@@.@.@@@@@@@@.@.@@.@.@@.@@@@@..@@.@@@@@@@@..@.@@@@.@@.@@..@..@
@@.....@@@@.@@.@.@@@@@@@@.@@@@@..@.@@...@.@@.@@@@@@@..@@.@@.@@@.@.@@.@@@@.@@@....@@@@..@@@.@.@..@@....@@@..@....@@.@.@..@.@@@@@@@@.@@@..@@.
.@.@@@@..@@@.@@.@.@@@.@@@@..@@@@@@@@@.@@@@.@@@@.@@@.@@@.@@@...@..@.@@...@@@@@..@@@.@@@..@@.@@@@.@@.@@@.@@@@@@@@.@.@...@.@.@@..@.@@@@..@@@@@
@@..@.@.@@.@@@@@@@..@@@@.@@.@@@@..@@@.@@.@@@..@@@@.@.@@.@@@@.@@.@@@@@@@@@.@.@...@@@...@@@.@@...@@@@.@@.@@..@.@...@@@@@@@.@@@.@@@...@@@@.@@@
..@.@@@@@@..@@..@.@@@@.@..@@@@....@....@.@@.@@.@..@.@@.@.@@@@@.@@@.@@@.@@@@@.@@@@.@@...@@@......@@.@@@.@.@@.@.@@@@@@@@.@@@.@@@@@@@@@@.@.@@.
@.@..@..@.@@@.@.@.@.@@@..@@..@@..@....@@@@@@.@@@@...@.@.@.@@@@@.@@@@@@@@@.@....@.@..@@@.@@@@.@@@.@@.@@@@@@.@@.@@@@@@@.@@@..@...@@@..@@...@@
.@@@@@...@@.@.@@@@@@@@@@@@.@@@..@.@.@@@..@.@..@@..@.@@@.@@@@..@..@..@@.@.@@..@..@@.@...@@@@@@@.@@@@.@@..@.@@@@@@@@@.@@.@@@.@@.@@.@..@@@@@@@
..@..@@@..@.....@.@@@@@@@@@@@.@.....@.@...@.@@@@@@@@@@@..@.@@@@..@.....@@.@.@@@@@@.@@@@..@.@.@@@@@@@@@...@.@@@.@@...@@.@.@@.@@...@@@@@@@@@@
@...@@@.@.@@@.@.@@@..@...@@@@@@..@@.@.@@.@.@.@@...@.....@.@@@.@...@@@..@@@@@...@.@@.@.@@@.@@.@@@@@@.@@@@@@@@@.@@@@@.@.@@@..@.@@@@...@@@@@..
@@@@@@.@@@.@....@.@.@.@@@@.@@.....@@.@..@..@@@@@@...@@..@@..@@@@@@@.@..@@.@..@.@@@@@@@@@..@.@@@.@@@.@@.@@@.@@@@...@......@.@@@.@@@@.@@@.@..
@@@@.@@@...@@@@@@..@@.@.@@..@@@.@@.@@@...@......@@@.@@@@@@....@@@.@@.@@@@.@...@@@@@@@@.@@..@@.@@@@.@@@.@.@@@@@.@.@@.@.@...@@.@@@.@@@@@@@@@.
...@@.@@@@....@@..@.....@@.@@...@@@..@.@@.@@.@@@.@@@.@@@@.@@.@@@@.@@..@.@@.@..@@@@@@.@@@@@@@..@@@@@@.@@@@@@.@@@@@.@...@@@..@.@@@@@@@.@@@@@@
@@.@.@.@.@.@@@@@@@@@@......@@@@@@@@@.@@..@@@@@@@@@@@.@@.@@@.@.@@....@.@..@@..@@@@..@@@....@@@..@.@@..@.@@@..@@.@.@@@...@@@@@@@@..@@.@@@....
@@@@.@@@@@@@@@@@@@@@@@@@.@@.@@@@.@@@@.@@..@@.@@@@.@@.@@@@.@.@@.@.@@@@.@@.@@@@@...@...@@.@.@@@@...@@.@@.@@@...@.@...@.@@.@.@@.@@@@.@@@@@@@.@
.@.@.@@@@@@@@@..@@.@@@@..@.@@.@@.@..@@..@@@@.@@@..@@@...@@@@.@.@@...@.@@@@@@@..@.@@.@@@@@.@@@@@@..@@@@..@@@@...@@....@@@@.@.@@@.@@..@.@@.@.
@@..@.@.@.@@@@@@.@@..@..@.@.@@@@@....@@@@.@@@@@@.@.@.@@..@@...@@.@..@@@.@.@@.@@@@@.@@.......@.@.@.@@..@.....@@.@@.@@@@..@@@.@.@@@@@.@@@.@@@
.@@@..@..@@@@..@@@@@@.@...@.@..@@@.@@@.@@.@@@..@@@@.@@@@.@@....@@@.@@@@@@@@.@@@@.@@.@@@@@@@@@......@@.@@.@@@@.@.@@@@.@..@@.@.@.@@@@.@@@@@@.
.@@@@@@....@@.@..@.@@@@.@@@@@.@@@.@@@@.@@@@@@@@..@.@@@@.@@@@@@@@@@@@@..@@@@@@.@@@@@.@@.@@@@@@@@.@.@@.@@@@@.@@.@.@@@@@@@.@@@@@@.@.@@.@.@@@.@
@@@@@...@@.@.@.@.@@@.@.@@@@.@..@....@@@@@@@.@...@@.@@..@@@..@@.@@@....@@@@@.@@.@.@..@..@@@.@@...@.@@@@@@.@@@@@@@..@...@.@.@.@.@@..@.@@@@@..
....@@@@.@.@@..@@.@@.@@.@@@@@..@@.@.@@.@@@..@@.@.@@...@.@.@.@@.@@@@@@.@@@@@.@.@.@..@@@@@@.@@@.@@@.@.@@@@..@..@@.@@@..@@@@..@.@@@@@@@@@@.@@.
..@@.@@@@.@.@@@..@@...@@@@@@@.@..@@.@.@.@@@@@@.@@.@@@.@@.@@@@@..@.@@@...@@@@@.@@.@@.@@..@@@@@@...@@..@@...@@@@@@@@@@@@.@@.@@@@@@.@@.@@@@..@
@@@..@@.@@@@@...@...@@@@@.@@...@.@@@@..@@.@.@.@.@@.@@@@@@@..@@@@.@@@@.@@@@@..@@.@.@.@.@@@.@..@.@@@@@@@@@@.@.@.@@@@@@@@@.@@@@@.@@.@.@@@.@.@.
@@@.@@..@...@@.@.@@@.@@.@@@@.@@@@@...@@..@@@@.@..@@.@@@@..@@@.@.@.@..@@.@@@@@@.@.@@@.@@.@@@@@.@@@@@@@@.@...@@.@@@@.@.@@@.@@@@..@@@@@.@@..@@
@@...@@.@.@@.@@@.@..@.@@@@@.@.@@@.@@@@@@.@@.@.@@@@@.@@@@@.@@@@@@.@@@@....@..@....@@@..@.@.@@@@@.@@@@@@@@@@@.@@@@@@@@.@@.@@..@..@@@@@..@..@@
@..@@@.@.@.@@.@@@.@@@@@.@@@.@@@@.@@.@.@@.@@@@@@@.@@@...@@.@@@@@@.@@@.@..@@@@@@.@@....@.@@@@@@@..@..@@.@@@.@@@@@.@@@@.@@@@@.@.@@@.@.@.@.@.@.
@@@.@@..@@@@.@.@..@@.@@..@@..@@.@.@@.@.@@.@..@@@.@@@@.@..@.@..@@@@@@@.@@@@@@@@@@..@@@.@@.@@..@.@..@.@@@@@@@.@@@.@.@@@.@.....@.@..@@@@@@...@
@..@.@..@@@@@...@@...@..@@..@@.@..@@@@.@..@@..@@@@..@@@.@@...@.@@@@@@@@....@@@.@@@@@@@@@@@@@.....@@..@@@@@@@@@@.@@@@@@@@.@@@@@@...@@..@@@@.
@.@@.@.@.@.@..@@@.@@...@@@..@.@@.@@@@@......@@@@@.@@.@@@@@@..@@...@...@..@@.@@.@@..@@.@@.@@.@@.@@@@@@.@@@..@@.@@@@@@@@@.@.@.@@@@.@@@@@@.@@@
..@@@@@@.@...@..@@@@@@@@@.@@@@@...@@@@@@@@@@@@.@.@@..@.@@@....@@@.@..@@@@@@@@@@.@@.@@@@.@.@@.@.@@@@@@.@@@@..@.@@@..@@@@.@@@@@@@@@..@@@@@.@@
@@@@@@.@@@.@@.@..@@.@..@.@.@.@@.@@@@@@...@..@@.@.@@@@.@.@@@..@.@@..@.@@@...@@@...@.@.@@.....@@.@..@@@@.@@..@@.@@@@@@@..@.....@@@.@.@@@@..@@
.@@....@.@.....@.@@@@....@@@..@...@@@@@@.@@@@.@@@.@@.@@@..@@.@@@.@.@...@@@.@.@@.@.@.@@@..@@@@@.@@@@@@@@@.@@.@.@@.@.@@.@@..@.@@@@.@@@@@@@@@@
@.@@@@@@@.@@@@@.@..@@@@@@.....@..@@@@@.@@@.@@@.@@@@.@..@@.@@@..@@@.@@@@@.@@@@@@.@@..@@.@..@@@@@@@@@@@@.@@.@@.@@@..@@.@@@@..@@.@@@@@@@@@.@..
@@.@@.@.@@@@..@@@@.@@@@@@@@...@@@@..@@..@.@@.@@@@@@@@.@.@@@@.@@@..@@@@@@.@@@@@.@@.@@.@....@@@@@@..@@@@.@@@@.....@@...@@.@@.@@@.@@@@.@@@.@.@
.@@@.@@@@@@.@.@.@@@.@.@.@..@@.@.@@@.@@@@@@@@@..@@.@.@@@@@@@@.@.@.@.@@.@@..@@...@.@@@@@@@.@.@@.@.@@.@..@@@..@@.@.@@@.@@..@@@@@@@@.@@@@@.@@@@
.@@.@@@.@@@.@@@..@@.@@..@@..@@@.@.@@....@@..@..@@@@@@@@@@@.@@@.@.@@@@..@@.@.@@@@@@@@@..@.@.@@@@@@...@@@@.@..@@.@.@.@@@@@.@..@@@@@@..@...@@@
.@@@@.@@@@@@@@.@@.@@@@@..@@@@.@.@@@...@@@.@@@..@@@@@@@@.@.@@@.@@.@@@.@@@@@@@@@.@..@.@.@@..@@@@...@@..@@.@..@.@@@@..@@@@@@..@@@....@.@@@@.@@
.@@.@..@.@..@.@@@@@@@@.@@@@@@@@@@..@@...@..@@.@@.@@@.@..@..@@.@@@@@@.@.@.@@.@@@.@@...@@@@@@@@@..@@@@@...@.@@@@..@@@.@.@.@.@@@@..@@@@@.@@..@
@@@.@@@.@.@@.@@@@.@.@@@.@@@@@@.@@@@.....@@@@@..@@@...@.@@@..@@@@.@@..@@@.@@@..@@@@..@@.@@.@..@@.@@..@.@@@@@.@@@@.@@....@@@@@@@@.@@@@@.@.@..
@@...@@@@@@@@@@@@@..@.@@@..@@@@@@@@@@.@@.@..@.@@@@...@.@..@@@.@@.@.@.@@@@@@@.@..@@.@@..@@@@@@@@@@@.@.@@@@@.@@@@@.@@@@..@@..@.@@@@.@@@@@...@
.@@@@.@..@@@.@@@.@@@@...@@@.@@@....@@.@@@@@@@..@.@.....@.@@@...@@@@@@@..@@@.@.@@@@.@..@@@.@.@.@@@@@@@..@@@@@..@.@@@@.@@@@@.@.@@.@@.@@@@.@..
@@@..@@@@.@@@@..@@..@@@@@..@.@.@.@...@.@@.@@@..@@.@.@@@@@@@.@@@@...@@..@@..@@@.@..@@@.@.@@@@.@.@@@@@@@@.....@@.@@@@@..@@@@@@....@@@.@@@@@@.
@@.@@@@@@@@@..@@@.@.@.@..@..@.@..@@@..@@..@.@@@@.@@@@@@@@@@@@@@@.@..@@@@@@@@@@@@.@@@@.@@...@@@.@@.@@.@@@@@@.@@@@..@...@.@@@@@.@.@.@@@@@@@@.
.@.@@@.@@.@@..@@.@.@...@.@.@@..@..@@@..@@@@.@@@..@@@..@.@.@.@.@@@@@@@@@@....@@.@@@@.@@@@@@..@@@..@@@.@@@@..@..@@@.@@@@@@@.@.@.@@@@@@@@...@.
.@....@.@.@@@@@.@@@@.@@@.@..@...@@@.@@.@@..@.@@@@@@@@.@.@.@@.@.@@..@@..@.@...@@@@@.@@@@@..@@.@@@.@@@@..@@.@@@@@@.@....@@@@@@@@@@@.....@@.@@
@..@@.@@@@@@@@@.@@@.@..@@@@.@@@@@.@.@@.@.@@@@@..@@@.@@.@@@..@.@.@@@...@.@.@@@..@@@@@@@@@..@.@@@@.@@.@@@@@@@@..@@.@.@@@....@@@@@@..@.@...@@@
.@@@@@..@@@.@..@@@.@@@.@.@@.@@.@@.@...@.@.@@..@@@@@@@...@@..@@@@@@@.@@@..@..@.@@@..@@@@@@.@@@@..@.@@@@@@@@@@@@.@.@@.@@@.@@@.@@.@.@.@.@.@@@.
@@@@@..@...@@@...@@@.@.@@@@...@..@@@@@@@@..@@...@.@.@@@@@.@@@@.@@@.@@@@@..@@@...@.@@@@@@@@.@@.@@@...@@@@@@.@@@@@.@@@@@@@.@@.@.@@.@@@..@@@@@
@..@.@@.@@@@@.@@.@@...@@@.@@@....@...@..@..@.@@@@.@@@@@@@@@.@.@@@@@@@@..@@@@@@..@..@.@@..@@@.@@...@.@.@.@..@@..@@@@.@.@.@..@@.@@.@.@@@@@@@@
@@.@.@.@@@@....@.@@@@.@@@..@.@@@.@.@@.@@..@@.@@@.@...@.@@@@@@@@@..@..@@@@@@@.@...@@@..@@@..@..@@..@@@@@@...@.@@.@@@@@..@@@@@@.@@@@@.@@@@@@.
@@..@@@@@@.@..@.@.@@@@.@@@@@.@@@.@@@@@@@.@@@@@....@@.@@..@@@@@@@@@...@.@@@.@@@.@@.@@@@.@..@.@.@.@@@@@.@@@@...@.@@@@@@.@.@@.@@@@@..@@@@@.@@@
.@..@@@.@..@.@.@...@@@@@.@@@@.@@@@@@@@@@@.@@.@@@@@.@@.@@.@@@.@@@.@...@.@@@@@@@.@.@@@@.@@@@@@@@@@@@...@@@@.@@.@@@@@@@.@@.@@@.@.@@.@@@.@@@@@@
@@@@.@@@@.@@@@@@@@@@.@@@@@...@.@@@@@.@@@@@@@@@.@@@..@...@@...@@@.@..@@@..@.@@.@@@@.@@@@.@@@@@@@@@.@@@@@@.@@@.@.@@@.@@.@.@..@@@@.@..@@@..@@@
....@..@@.@.@...@@@@@@..@@.@@.@@..@@@..@@..@@.@..@@@@.@@@.@@@@@.@@.@@..@..@@..@@@@@..@.@@@@@@@@..@.@@..@@@@..@@@@..@@...@...@.@..@@@@@@@@..
@@..@@@@.@@.....@.@@@@..@.@@..@@@.@@@@@@@@@@@@@@.@@@@.@@@@.@@.@@.@@@@@.@@.@..@@.@......@@@.@@@..@@@@@@@@@@.@.@@...@@@@@@@@.@.@@.@@@@@.@@@@.
@@@..@.@@.@@@@.....@@@.@.@@@.@@@.@....@@@@.@.@.@@@..@@@.@@.@@@.@@.@.@@..@@@@@.@.@@..@.@.@...@@@.@.@.@@@@.@@.@@@.@@..@..@@@.@.@@.@@..@..@@@.
..@@.@@@@@@@@.@.@@..@..@@@..@..@@@..@.....@@@@..@@@.@@.@@@.@@@....@@.@.@@....@@@@@@.@@@.@@@.@@@.@@@.@@@@@@@.@@....@@@@..@.@....@@@@.@..@@@@
@..@.@@.@@.@.@@@.....@.@@@@.@.@@.@@..@@@@.@..@@@@@@.@@@@@.@@@@..@@@@@@@@@@@@@.@.@.@@@.@.@@@@@@@@.@.@@@@.@@@.@@@@@.@@@@@@..@@@@@..@.@.@@@@@@
@@@@@..@@@..@@@@@@.@@@.@.@.@@@..@@@@@@@.@@....@@@@@@@..@@..@..@@.@@@@@.@.@@@....@@@@@@.....@....@@.@@@@.@@@.@@@@.@@@@.@@@@@@..@@.@@...@@@.@
.@....@@.@.@..@.@.@@@@@@@@@.@@.@@@.@...@.....@@.@@...@@@@@@@..@.@@@@@.@@.@@@@@@@.@@..@.@@@.@.@@@.@@@@@@.@@..@@@.@@..@@@.@@@.@.@@...@@@@..@.
@..@@@@@@@@.@@@.@@@@.@..@.@@@.@@@@..@@.@@@@.@@.@@@.@@@@@@@@.@@@..@@..@@@@@.@@.@.@@.@.@@@.@@@.@@.@.@@@@....@@@..@.@@.@.@.@@@.@@@@@@@@@.@@@@@
.@@@.@@@.@@@@.@.@@@@@@@.@.@@@@@@@.@@@@@@.@@.@@@.@@.@.@.@@@@@@...@@@@@.@@@@....@.@@@@@..@.@@@@@@@@@.@.@@.@.@@...@.@.....@@.@@@@@@@..@@@.@.@.
@@@@..@@@.@@@.@@@@@@@@@.@@.@@..@.@@.@@...@@.@@@.@@.@@..@@..@@@@.@@.@@@@@@@@@.@.@@@@@@.@@@@..@..@@..@@@.@@.@@@@@@.@@@@.@.@.@@@@@@@@@....@@.@
@@@.@@@@@@.@@....@@@@@@@@@@@@@@.@@@@@@.@@@@.@.@.@@@@.@@@..@@.@@...@@@@@.@@@@@..@....@@@....@@.@@.@...@.@@@.@@...@@.@@@@.@@@@.@..@.@@@@@@@..
@@@.@@..@..@.@@@@.@@@@@@@.@@@@@.@..@@.@@@@.@@@@.@.@@.@.@@@.@@@..@@@..@@@@...@@.@@@@.@@@@@..@.@@@@@@.@@@.......@@@@.@@@@@..@@..@@@@@..@@@@@@
@@.@@@@..@.@..@..@.@.@.@.@@@@@...@.@.@.@.@....@.@@.@@@.@.@@@@@@...@.@@@.@@@@@@@.@@@.@@@@.@....@@@.@.@@.@.@@@@@..@@@@@@....@@@..@@.@....@@@@
@@.@@@@@@.@@.@@@.@.@@@.@..@@@..@@.@@.@@..@@@.@@@.@@..@@@@@@@.@@.@.@..@@@@@@@@.@@@@@...@@.@@@..@.@@@@@@.@@@...@.@.@.@@@..@.@@...@@@@..@@@@@.
.@.@.@..@@@@@@@@.@.@@..@..@@..@@@.@.@.@@.@@.@@@@@@..@.@@.@..@.@@@.@.@@@.@@@@@.@.@@@@.@.@@...@.@@@..@@@@..@.@@@.@.@.@@..@@@@@@.@@@@..@.@@@@@
.@@.@.@@@@@@.@..@@@@@@.@@@@.@.....@@@@@@.@@..@.@@@..@@..@@@@.@.@.@@.@..@.@@@@.@@@@@.@@..@@@.@..@...@@@@@@@..@@.@@@.@@@@@.@@.@.@@@@@.@@@@..@
..@.@..@@.@@.@@@@@@@..@.@...@..@@@...@@@.@@@@....@@@@....@@@@@@@.@.@@.@@@@@@.@@.@@...@@@@..@.@..@.@@@@@.@@..@@@.@@@@..@@@.@@@@..@@.@.@..@@.
@.@@@@@@@@@.@@@@..@.@.@@@@..@@..@@@@.@@@@@..@@...@@@@..@.@....@.@@.@.@@.@.@.@.@@@@@@.@@.@....@.@.@..@@@.@..@@@@.@@@@@.@.@.@@@.@.@.@.@..@@@@
@.@@@@.@...@@@.@@..@.@@.@@@...@..@@.@@@@@@@@.@@@@@.@.@..@..@.@@@.@...@@@.@@..@.@..@.@@@...@@@@@@@@@@@@..@@@@@@..@@@..@@@.@.@@@..@@@@@.@.@@@
.@@@@@@.@....@.@..@@@@@.@.@@.@@@.@@@@..@.@.@.@.@.@...@.@@.@@@@..@@@@@.@@.@..@@@@@@.@.@@@@@@@@@@@.@..@.@@..@.@@@@@@.@@@.@@.@@@@@.@.@..@.@@..
@@.@@@.@.@@@@@..@.@@@@@@.@@.@.@@@..@@@@@@@.@@@@..@@@@@.@..@.@.@..@.@@@@@.@.@@.@.@@@@@@@...@..@.@.@@..@@..@@@@@.@.@@@@.@@..@@@...@.@.@.@@.@@
@@@@@@@@.@..@.@@.@..@@@....@....@..@@@.@@@@.@@@..@@@@@@@..@.@@@@@.@.@@..@@@..@@.@@@@.@.@@@.@@.@@@@@@..@.@@.@..@.@@.@@.@@@@.@...@@@@....@@.@
.@@@@@..@....@@@@...@@@.@.@.@@@@.@@..@.@@..@@@@..@.@@@@@@@@@.@..@.@@@@.@@@@@.@@@.@.@@@..@@...@.@.@..@@@.@@.@..@@.@@@.@@.@@.@@@@.@@..@@@@@@.
.@@@..@@@@@@@....@@@@.@@@@@.@@@@@@@.@@@@@.@@.@@@@.@.@.@@.@@@@..@@.@......@@@@.@@@@....@@.@@@.@.@@.@@@@@@.@@@@@.@.@@...@@.@@.@...@@@..@@@@..
";

static TESTINPUT: &str = "
..@@.@@@@.
@@@.@.@.@@
@@@@@.@.@@
@.@@@@..@.
@@.@@@@.@@
.@@@@@@@.@
.@.@.@.@@@
@.@@@.@@@@
.@@@@@@@@.
@.@.@@@.@.
";

static VERBOSE: bool = false;

fn main() {
    println!("********************");
    println!("ADVENT 2025 DAY 4");
    println!("********************");

    let mut input: &str;
    let mut args = std::env::args();
    if args.any(|a| return a == "--test") {
        println!("using test data");
        input = TESTINPUT;
    } else {
        input = INPUT;
    }
    input = input.trim();

    part1(input);
    part2(String::from(input));
}

fn part1(input: &str) {
    let width: i32 = input.lines().nth(0).unwrap().len() as i32;
    let height = input.lines().count() as i32;

    let start_time = std::time::Instant::now();

    let mut answer = 0;
    let mut y = 0;
    for l in input.lines() {
        if l == "" {
            continue;
        }
        let mut x = 0;
        for c in l.chars() {
            if c != '@' {
                x += 1;
                continue;
            }
            let n_neighbors = test_elem(x, y, width, height, input);
            if VERBOSE {
                println!("({}, {}) has {} positive neighbors", x, y, n_neighbors)
            }
            if n_neighbors < 4 {
                if VERBOSE {
                    println!("({}, {}) valid for removal", x, y);
                }
                answer += 1;
            }
            x += 1;
        }
        y += 1;
    }

    let elapsed = start_time.elapsed();
    println!("------------ PART 1 -----------------");
    println!("Anwser is \n{}\n", answer);
    println!("processing time {}us", elapsed.as_micros());
    println!("-------------------------------------");
}

fn part2(input: String) {
    let width: i32 = input.lines().nth(0).unwrap().len() as i32;
    let height = input.lines().count() as i32;

    let start_time = std::time::Instant::now();

    let mut answer = 0;
    let mut removed_iter = 1;
    let mut bytes = input.into_bytes();

    let mut y = 0;
    let mut x = 0;
    while removed_iter > 0 {
        removed_iter = 0;
        for i in 0..bytes.len() {
            let b = bytes[i];
            if b == b'\n' {
                x = 0;
                y += 1;
                continue;
            }
            if b != b'@' {
                x += 1;
                continue;
            }

            let n_neighbors = test_elem_bytes(x, y, width, height, &bytes);
            if n_neighbors < 4 {
                println!("({}, {}) valid for removal", x, y);
                removed_iter += 1;
                bytes[i] = '.' as u8;
            }
            x += 1;
        }
        println!("iteration state");
        for b in bytes.to_owned() {
            print!("{}", char::from(b).to_string());
        }
        println!("");
        answer += removed_iter;
    }

    let elapsed = start_time.elapsed();
    println!("------------ PART 2 -----------------");
    println!("Anwser is \n{}\n", answer);
    println!("processing time {}us", elapsed.as_micros());
    println!("-------------------------------------");
}

// test all 8 adjacent positions without overflowing
// x x x
// x o x
// x x x
// Returns the count of matching neighbors
fn test_elem(x: i32, y: i32, width: i32, height: i32, input: &str) -> i32 {
    // (delta x, delta y)
    let tests: [(i32, i32); 8] = [
        (-1, -1),
        (0, -1),
        (1, -1),
        (-1, 0),
        (1, 0),
        (-1, 1),
        (0, 1),
        (1, 1),
    ];
    let mut c = 0;
    for t in tests {
        let target_x = x + t.0;
        let target_y = y + t.1;
        if target_x < 0 || target_x > width - 1 {
            continue;
        }
        if target_y < 0 || target_y > height - 1 {
            continue;
        }
        let neighbor = input
            .lines()
            .nth(target_y as usize)
            .unwrap()
            .chars()
            .nth(target_x as usize)
            .unwrap();
        if neighbor == '@' {
            c += 1;
        }
    }
    return c;
}

fn test_elem_bytes(x: i32, y: i32, width: i32, height: i32, input: &[u8]) -> i32 {
    // (delta x, delta y)
    let tests: [(i32, i32); 8] = [
        (-1, -1),
        (0, -1),
        (1, -1),
        (-1, 0),
        (1, 0),
        (-1, 1),
        (0, 1),
        (1, 1),
    ];
    let mut c = 0;
    for t in tests {
        let target_x = x + t.0;
        let target_y = y + t.1;
        if target_x < 0 || target_x > width - 1 {
            continue;
        }
        if target_y < 0 || target_y > height - 1 {
            continue;
        }
        let pos = (y * (width + -1) + x) as usize;
        let neighbor = input[pos];
        if neighbor == b'@' {
            c += 1;
        }
    }
    return c;
}
