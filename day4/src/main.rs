static INPUT: &str = "
@@@@@..@@@@@@@@..@@@@.@@.@.@@.@@@@@@@.@@.@..@@@@..@@@..@.@@..@@@@.@......@@@..@@@@.@@@@@@@@.@@@@@.@@@@@@@@.@.@@..@.@@@@@@@@@@.@..@..@@..@.@
@.@..@@.@..@@@@.@..@@@..@@....@.@.@...@.@@..@.@@.@@@@.@@.@@@..@..@.@.@..@@@@@.@@@.@@@..@@.@@@@.@@.@..@.@@@@@@@.@@...@@@@.@@.@@@@@@@@@@..@.@
@..@@@@@.@.@@.@.@.@@@@@...@.@@.@.@@@@@.@@.@@...@@@...@@@@@@@@@@@@@@.@.@@.@.@@@..@.@@.@@@@..@@.@.@.@@@@@@@@@.@.@@@@..@.@@@@@@@@.@@@@@@.@@@..
@@@.@@@@.@.@@@@...@@..@@@.@.@@@.@.@.@@..@.@@@@@@@@@@@.@@.@@@.@@.@@@@@@@@@@@@..@..@@@..@@@.@.@@..@@.@.@..@.@@@@.@@@@@.@@.@@@.@@@@@..@@..@...
@@@@..@.@...@@.@.@@..@@@@.@@@@@@....@@..@@@.@@@@@@@@......@@@@@@.@@...@@.@@.@@@@@.@@..@@.@@.@@@.@@@@@@@@...@@@@.@.@@.@..@..@@@.@...@@.@...@
@..@@@@@..@@.@.@@..@@@.@@.@@@@@@...@@@@@..@@.@@@@@..@.@...@@@..@@.@@@@.@@....@@@@@@@@@@@@.@@@.@@@@..@@@@.@..@@@@@@.@.@...@..@.@..@.@@.@@.@@
.@..@@@@@..@@.@@@@@@@@.@@@.@@@.@.@...@..@@@.@.@@@.@@.@.@..@.@@..@@..@.@.@@@@..@.@@@@@@@@@@@@.@..@...@.@@@@@@@@@.@@...@@@.@.@@@..@@@.@@@@@@@
@@@@.@@@@.@..@.@.@..@..@@.@@@@@@.@......@@@..@@@.@@@.@.@@@@..@@@.@@@..@@@@@..@@@@.@@@@@..@@.@.@@@@@..@@@.@@.@@@@@.@.@@.@@..@@@..@.@.@.@@.@@
@@@@@@@@.@..@@@@.@.@@..@.@.@@@@@....@.@@@..@@.@@@@@..@@....@@.@.@@@@@@@.@@@@@@@@.@@.@..@.@@@..@.@@@.@@..@@@.@@@@@@@@@@.@.@@@@..@@@@@@@@.@@@
.@.@@...@.@.@@@@@.@@@@@@@...@..@@@@@.@.@@@@@@@@@.@@..@.@@.@@@..@@@.@@@.@@@.@.@@.@@@@@@@@@@..@.@@@@@@@@@@@.@@@....@@.@.@@@@.@@..@@@@@@.@@@@@
@@@@..@..@.@@.@@@@.@.@@@@@@@@@@@.@@@....@@.@@@@.@..@@..@@.@@@@.@.@.@@.@@@.@.@@@@.@.@@@@@.@@@..@.@@@@@@..@...@@@@..@@@@@@@.@@@@@@@@@.@.@@@@@
...@@@@@@@@.@@@@...@@.@..@@@@@@@@@.@@@.@@@@.@@.@@....@@...@@@.@.@.@@@@@@@@@@.@@.@.@.@@@.@@..@@..@@.@.@.@.@.@.@@@@.@..@.@..@@@@.@.@@@@@.@@@.
@@@...@@@@@..@.@.@...@@..@.@@@@..@@@@...@@@@.@@@@@.@@@@.@@@@@..@.@@@@@.@@@@.@@@.@@@@..@@@@@..@.@@@...@@...@@@@@@@@.@.@@@..@@.@@@.....@@.@@@
.@@@@@.@@@@@@@..@@.@@@@@@@@@@.@@.@@.@@@@@.@@@@@..@@@@@@@@@..@@@@@@@@@.@@@..@.@.@@....@@..@..@.@@@.@@@@@@...@@@@@@@@@@@.@.@@..@.@@.@@@@.@@..
..@@@@@@@@@@.@.@@@@@@.@..@@.@.@@@@@@@@.@.@@@@@@@@.@.@@@.@@@@.@@@..@@..@@@@@.@@@.@@@@@@.@@@..@@@@@...@@@.@@@.@.@@...@@.@@@.@@@@@@@@@@@@@@@@@
@@.@..@@@.@@@.@@@@@@@@@@@..@..@.@@.@@@.@@@@@@@.@..@..@@@..@@@...@..@@@@@...@@.@@@@@@@@...@@..@@.@@@@....@@@@.....@.@...@@@..@@@@.@@@.@@@@@@
@@..@@.@@@.@@@@..@.@@@.@@.@@@@@@.@..@@@@@...@@@@@@@..@.....@@.@@.@..@@@..@@@@.@@@..@.@.@@@@.@@@@@@@@@@@@@@@@.@@.@.@.@@@@.@@..@.@@...@..@.@@
@@@.@@@@@@@@@@.@@@@.@@@@@@@@.@@@@@.@@@.@@..@.@@..@@@@@..@.@.....@.@@@@@..@.@@@.@@@@.@..@..@..@@@...@@@@..@.@.@@@@.@...@@@@@@@...@..@@.@@.@.
@.@@...@@.@@@@@@@..@.@.@@@..@@.@.@@@@...@.@@@@@@@@@@@@@@@..@@@@.@@....@@@@@...@@.@@.@@@@@@.@@.@@.@@.@@.@@.@@@.@.@.@@@@.@@.@.@@..@@..@.@@@@@
@@@@.@.@.@@@@@@@..@@@@@..@@.@.@@@.@@@.@.@@@@@@@@@@@@@@@@@...@@@....@.@.@@@@@@.@....@..@@.@@@@@..@@.@@@@@.@@@@.@@@@@..@@@@@.@@@@.@.@.@@@..@.
@@@.@@.@@@.@@@@.@@.@@@.@..@@.@..@@@@@.....@.@@.@.@@.@@.@@@.@.@@@.@@.@@@@..@..@@@..@@@@@.@....@@..@.@@@@@.@.@@@@..@@@@@@@@.@@....@@.@@.@@@..
.@@.@@.@@..@@@.@@@@@@@.@@@.@@@@@@@..@@.@@@.@@@@.@@.@..@@@.@@.....@.@@...@@.@.@@.@@@@@@@@.@@..@@@.@.@.@@.@@@@@@@.@..@@@@.@@@@@@@@..@..@@.@..
@@@...@@@.@@@@.@.@@.@@..@@@@@@@@@@@@.@.@@.@..@@@@@.@@@...@@@.@@.@.@.@......@@.@@.@.@@@.@@@@@..@@.@.@@..@@@@@@@.@@@..@..@@...@@@@@@@@@@@@@.@
@@@@.@....@@@@@@@@@@@..@@..@.@@..@@@@.@@@@@.@.@@@.@.@@.@@@@@@@@.@...@@.@@.@@@.@@@.@..@@.@@.@@..@@.@...@@@.@.@@@...@@@.@@@@@@@@.@.@@.@..@@@@
@@@@.@.@.@@@@@@@@.@@@@@.@.@.@.@.@@.@@@.@@@.....@@.@.@.@@@.....@@..@.@@@@@.@...@@@@@@.@@@.@.@..@@.@@@@@...@@@@.@.@.@..@@@..@@@@@@.@@.@@@.@..
..@@@.@.@@@@@@@@..@@@..@@@@@@@@@@.@.@@@@@@@@@..@@@@...@@@@.@..@@..@@@@.@@@@.@@@.@@.@@@@....@.@.@..@.@.@@..@@.@@@@@@.@...@@.@@@.@..@@@@.@.@@
..@@@@@.@.@@@.@@..@.@..@.@@@@@@@@@.@...@..@@@@@.@@@@@.@...@@....@@@@@.@.@@.@.@.@.@.@.@@@@@@...@@..@...@@@@.@@@@.@.@..@.@@@@@@@@@@.@@@@.@.@@
.@@@@@..@@@@.@@@@@..@@@.@@.@..@...@@@..@@@@@.@@.@@..@@@.@@..@@...@@@.@.@...@@.@@@@@..@@@@@.@@@@@@.@.@@@@.@.@.@.@@@@@.@@@@...@@@@@.@@@@@@.@.
@@@.@@..@...@@@@@@..@@@@@@@...@@@@@@@@......@@.@@.@@.@.@.@.@@..@@..@@.@.@.@@.@@@.@@@@@@@@@@@.@@.@@..@@@@...@@@@@@@@.@.@@@.@.@@@..@@@@@@...@
@..@@..@@@@@.@@@@.@.@@@.@..@.@.@.@.@@@.....@@@.@.@.@@.@@.@@..@@@@@@@@@...@@....@.@.@@@..@@..@@@@@...@@@@@@@@@@@@@@@@@@@.@...@@@@..@.@.@@@@@
@@..@.@@@.@@@..@.@@.@@@@@@..@@.@..@@@@@@.@@@.@@@...@@.@.@@@@.@.@@@@@..@@@@@@.@@@@.@.@@@@@@@@@@..@@.@@.@@.@@@.@.@@@..@@.@@.@@.@.@@@@@@@..@..
@..@@.@..@@@@@@@.@.@...@.@@@@@@.@@@@@....@@@@@....@@@.@@..@@@@..@@@.@.@@@@@@@@.@..@@@@@..@@@@@@@@.@@@.@@@@@@@@.@@@@.@@..@@...@@@@@.@@@.@@@.
@@@@@@@..@@@.@..@.@..@@.@.@@@@.@@@@.....@@.@.@@@.@@..@@.@@@.@..@@.@.@@.@.@.@@.@@@.@@.@@.@@@@@.@..@@.@...@@.@..@@@@@@@@@..@@@@@.@@.@@..@.@.@
@.@@@.@.@.@@.@@@@.@@....@@@@@.@@@..@..@@....@.@@@@@@..@@@.@@@@@@..@.@.@@@....@.@...@@@.@@@@@.@.@.@@@@@..@@@.@.@@..@@.@.@.@@@@@@.@.@..@@.@.@
.@@..@@.@.@@@@@.@@.@..@@.@@.@@@@@@@@...@.@@@@@@..@@@@@.@@.@.......@@.@@@@@@.@.@.@.@@@.@.@@@.@..@.@@@@...@@@@.@@..@..@@@@@.@@@@@.@@@@@@@@@@@
@@@@@@@@@.@...@@..@.@@@@@.@@@..@@@@@..@@@@.@.@.@.@@@@@@@@@@@@.@...@.@@@@@.@@.@@@@@@.@@@@@@@.@..@@@@.@.@@@@@@@@..@.@@@@@@@.@@.@@..@@@@@@@@@@
@@@...@@@@@@@.@@@@@@..@.@@@.@@@.@..@@.@@.@@.@@.@.@@.@.@@@..@@@@@....@@@@.@..@@...@@@@@@.@.@@.@@@..@.@.@.@@@@.@@@...@@@@@@.@@@..@.@@.@@.....
@@.@@@@@.@.@@@@...@@@@@@@.@.@@....@@.@.@@.@...@@.@@@@@@......@.@@@@@...@.@...@@@@@@@.@@..@@@.@@@@@.@.@@.@@@@..@@.@.@@@@@@.@@...@@..@@@@@.@@
@@@.@@@.@@..@@@@....@.@.@.@.@@@@.@..@@@@.@@@@@@@@@@..@.....@.@@.@@@.@@@@@@.@.@@.@@.@.@@@@@.@@@@@@@..@@@@@.@...@@@..@....@.@@@.@@.....@..@.@
@@@.@@.@@@@..@@@.@.@@.@..@@@@.@@.@@@.@@.@@.@@@..@@.@..@@@.@.@@@@..@.@@@@@.@..@@.@.@@@@@@.@@@@@.@.@@.@@@@.@@@..@.@@.@@.@.@..@@@.@.@@@.@@.@@@
@.@@@@@@@@..@@@@@@@@@@..@@@@.@@....@.@...@@@@....@@@@.@@@@.@@@@@@.@@.@..@.@@@@@.@.@@@@@..@@.@@..@@@.@@.@.@@.....@@@..@@@@..@@@@@.@@.@@@@..@
..@@@@@@@@@.@@@.@@@@@.@@@..@.@...@........@@@.@@.@@@@@...@.@.@@.@..@..@@@.@.@...@@@.@.@@.@..@@@@..@@@@.@......@@.@@..@.@@..@@@..@.....@@@.@
.@@@@..@.@@.@@@.@@@@@@@.@@@..@@..@@@.@..@..@@@.....@@.@@@@@@@@.@.@.@.@@@@@@..@@@@@@.@@.....@.@..@@..@@..@@@.@@@@.@@@.@@.@@@.@.@@..@@.@@@..@
.@@@@@@@@@@@@@.@@@@.@..@@.@..@@.@@.@.@@.@@@@@@@.@@.@@@...@@@.@@..@@..@.@..@@@@@@@@@@@@.....@@@@@@@@@@@@.@@.@@.@@@.@@.@....@@@...@@.@.@@.@@.
.@....@@@@@@@@@@..@@.@@@@..@@@@@.@@@@@@..@...@.@.....@@@@@@...@@.@@.....@@@@@@@.@@@@.@@.@.@@@.@@.@@@@@@@@@..@@.@.@@@.@@@.@@@@.@@.@.@..@.@.@
@@@@.@@.@..@@.@@@@@@@..@.@.@..@..@@@.@@@@@@@.@.@.@@@..@@@@@@.@@@.@.@..@@@@@@@@@....@@.@@@@@@..@@@..@.@@@@@..@@....@@@@@@.@..@@@...@.@.@..@@
@@.@@@@...@@.@.@@.@@@.@@@@@....@@@@@@.@@.@..@.@.@@.@@@@.@.@@@@@@..@@@...@@@@@@@....@.@@@@.@@@@@.@@@.@@..@@.@.@..@@@@@@@.@..@@@@@@@@..@@.@@@
.@@@@.@@@@.@.@...@.@@@..@..@@@@@@@@.@.@..@.@..@@@@@.@..@@@@@@.@@@@@@@.@@@.@@@...@.@.@@@@@@.@@@...@.@..@@@@@.@..@..@.@..@@@@@@@@@@.@@@.@.@@.
@...@.@@@@@.@@@@@..@@.@@@.@@@@@..@@@@@@@@@@@...@@@@@@.....@@.@.@.@@@@@@@@..@@@@@@@@@@@@.@.....@@.@..@@@@.@...@@@@@@@@...@@@.@@@@.@@@@@@@...
.@.@..........@...@....@...@@.@@@@@@@.@@.@...@@.@..@@..@@@..@@@@...@@...@@@..@@..@@@@@.@@@@@@@.@...@@@@@@@@@@..@..@@@@@@.@.@@@@..@.@@@@@.@.
@@.@@@@.@@.@@@@.@@.@@@@.@@@.@.@@.@@@@@.@@@.@..@@@@@.@@@..@@..@@.@.@@...@@@....@@..@@..@.@@@...@@@@.@@...@..@@@@@..@@@@@@.@@.@.@@..@@.@.@@@@
@@@@@....@....@@.@..@@@@...@...@@.@.@@@..@@@@.@..@.@@@@.@@@@..@.@.@.@@@@@..@@@@.@@....@.@.@.@..@..@@.@..@@@@@.@@@.@@@@@@@@.@@@@@@.@@@@.@@.@
@.@....@..@@@@@@@.@@@.@.@@@@@.@.@@@.@@@@@@@@.@@@.@@@.@@@@.@.@..@.@@@@@@..@@.@..@@@.@.@@@@.@@@.@@@@..@@@@.@@@@@..@@@.@..@@@@.@.@@@@.@@@.@...
..@@@@@@@@...@@@@.@@.@@@..@@@@..@@.@@.@..@......@...@@....@@.@@@@@@.@@@@@@@@@@@..@@@.@.@@@@.@..@@.@.@@.@..@.@@@@@..@..@@@@@@.@.@.@.@@.@@@@@
@.@....@.@@...@@@@@@.@@@@@.@@@@@@@@.@.@...@.@.@@@.@@@@@@......@...@.@@..@@.@@@@.....@@@@@@@...@@...@@@.@@.@@@@@@@@@@@@@.@@@@@@@.@@@@@@.@@@@
@@@@.@@@@@@..@@.@@..@@.@..@.@..@@@@@@@@@@@....@.......@..@.@@.@@.@@@@@@@@@@.@@@@@@@..@..@@.@@@.@@.@.@@.@...@..@..@@@.@.@@@..@@@.@..@.@@@.@@
@@@.@@.@@@..@@@.@@.@@.@@.@@@@@@@@@.@.@.@@@.@@.@@@...@@.@@....@@@@.@@..@@@@@@.@@@.@@@@@.@@....@@@@@@.@...@@.@.@@@.@@@@.@@@@...@@@@@@@.@@.@@@
@.@@@@..@.@...@@@@@@@@@..@@@@@@@@@@@.@..@@@@@.@....@.@.@@@.@@.@...@.@.@@@@...@@@...@..@@@@@@@@@.@.@@..@@@@@@.@@.@...@@..@@.@@.@@@.@..@.@.@@
.@@@.@.@@...@.@@@@@@@@@@.@@@@.@.@.@@@@@.@.@@@@@@@@@@@.@.@@@@@@@@@.@...@@@@.@@@@@.@...@@.@@.@@@@..@@@@@@@.@@@..@@@.@@.@@@@@.@@@@@@.@@@@@@..@
@.@@.@@.@@@.@@@@@@.@@.@@.@.@@@.@@..@@.@.@@@@@.@@@@....@.@...@@@@.@.@..@@@.@@@.@.@.@.@.@...@.@@.@@@@.@@.@@..@.@@@@@@@.@.@..@.@@.@.@.@@.@@@@.
.@@..@..@@@@@@@@.@@@@@.@.@.@.@@@@@....@@..@@.@.@.@@@@@@.@..@..@.@@..@@@@@@.@..@.@@.@@@.@..@..@.@@.@@@@@@@.@@.@@@@.@..@.@@.@@@.@@.@@@.@.@..@
.@@.@@@.@@....@@..@.@.@.@@@..@.@@@.@@@@@@.@@@@.@@@.@@.@@...@.@.@@@@@@..@..@.@.@@@@@@@@@...@@@..@.@..@..@@.@@@..@..@@@.@.@@@@@...@@@@@@@@@.@
@@.@..@@@.@@...@@@@@..@@....@@@@@@@@@.@.@@@@.@...@.@@@..@@@@@@@@..@@@.@@..@.@@@..@@@@.@@@..@@@.....@...@.@.@..@.@.@@@@...@@@@.@@@@.@.@@@..@
@@@@@.@@..@@@@.@@.@@.@.@@@@.@.@@@@@@.@@..@@..@@@...@.@@@@....@@.@.@..@.@@@...@@.@.@@@@@@@@.@.@@.@.@@.@@@@@..@@.@@@@@@@@..@.@@@@.@@.@@..@..@
@@.....@@@@.@@.@.@@@@@@@@.@@@@@..@.@@...@.@@.@@@@@@@..@@.@@.@@@.@.@@.@@@@.@@@....@@@@..@@@.@.@..@@....@@@..@....@@.@.@..@.@@@@@@@@.@@@..@@.
.@.@@@@..@@@.@@.@.@@@.@@@@..@@@@@@@@@.@@@@.@@@@.@@@.@@@.@@@...@..@.@@...@@@@@..@@@.@@@..@@.@@@@.@@.@@@.@@@@@@@@.@.@...@.@.@@..@.@@@@..@@@@@
@@..@.@.@@.@@@@@@@..@@@@.@@.@@@@..@@@.@@.@@@..@@@@.@.@@.@@@@.@@.@@@@@@@@@.@.@...@@@...@@@.@@...@@@@.@@.@@..@.@...@@@@@@@.@@@.@@@...@@@@.@@@
..@.@@@@@@..@@..@.@@@@.@..@@@@....@....@.@@.@@.@..@.@@.@.@@@@@.@@@.@@@.@@@@@.@@@@.@@...@@@......@@.@@@.@.@@.@.@@@@@@@@.@@@.@@@@@@@@@@.@.@@.
@.@..@..@.@@@.@.@.@.@@@..@@..@@..@....@@@@@@.@@@@...@.@.@.@@@@@.@@@@@@@@@.@....@.@..@@@.@@@@.@@@.@@.@@@@@@.@@.@@@@@@@.@@@..@...@@@..@@...@@
.@@@@@...@@.@.@@@@@@@@@@@@.@@@..@.@.@@@..@.@..@@..@.@@@.@@@@..@..@..@@.@.@@..@..@@.@...@@@@@@@.@@@@.@@..@.@@@@@@@@@.@@.@@@.@@.@@.@..@@@@@@@
..@..@@@..@.....@.@@@@@@@@@@@.@.....@.@...@.@@@@@@@@@@@..@.@@@@..@.....@@.@.@@@@@@.@@@@..@.@.@@@@@@@@@...@.@@@.@@...@@.@.@@.@@...@@@@@@@@@@
@...@@@.@.@@@.@.@@@..@...@@@@@@..@@.@.@@.@.@.@@...@.....@.@@@.@...@@@..@@@@@...@.@@.@.@@@.@@.@@@@@@.@@@@@@@@@.@@@@@.@.@@@..@.@@@@...@@@@@..
@@@@@@.@@@.@....@.@.@.@@@@.@@.....@@.@..@..@@@@@@...@@..@@..@@@@@@@.@..@@.@..@.@@@@@@@@@..@.@@@.@@@.@@.@@@.@@@@...@......@.@@@.@@@@.@@@.@..
@@@@.@@@...@@@@@@..@@.@.@@..@@@.@@.@@@...@......@@@.@@@@@@....@@@.@@.@@@@.@...@@@@@@@@.@@..@@.@@@@.@@@.@.@@@@@.@.@@.@.@...@@.@@@.@@@@@@@@@.
...@@.@@@@....@@..@.....@@.@@...@@@..@.@@.@@.@@@.@@@.@@@@.@@.@@@@.@@..@.@@.@..@@@@@@.@@@@@@@..@@@@@@.@@@@@@.@@@@@.@...@@@..@.@@@@@@@.@@@@@@
@@.@.@.@.@.@@@@@@@@@@......@@@@@@@@@.@@..@@@@@@@@@@@.@@.@@@.@.@@....@.@..@@..@@@@..@@@....@@@..@.@@..@.@@@..@@.@.@@@...@@@@@@@@..@@.@@@....
@@@@.@@@@@@@@@@@@@@@@@@@.@@.@@@@.@@@@.@@..@@.@@@@.@@.@@@@.@.@@.@.@@@@.@@.@@@@@...@...@@.@.@@@@...@@.@@.@@@...@.@...@.@@.@.@@.@@@@.@@@@@@@.@
.@.@.@@@@@@@@@..@@.@@@@..@.@@.@@.@..@@..@@@@.@@@..@@@...@@@@.@.@@...@.@@@@@@@..@.@@.@@@@@.@@@@@@..@@@@..@@@@...@@....@@@@.@.@@@.@@..@.@@.@.
@@..@.@.@.@@@@@@.@@..@..@.@.@@@@@....@@@@.@@@@@@.@.@.@@..@@...@@.@..@@@.@.@@.@@@@@.@@.......@.@.@.@@..@.....@@.@@.@@@@..@@@.@.@@@@@.@@@.@@@
.@@@..@..@@@@..@@@@@@.@...@.@..@@@.@@@.@@.@@@..@@@@.@@@@.@@....@@@.@@@@@@@@.@@@@.@@.@@@@@@@@@......@@.@@.@@@@.@.@@@@.@..@@.@.@.@@@@.@@@@@@.
.@@@@@@....@@.@..@.@@@@.@@@@@.@@@.@@@@.@@@@@@@@..@.@@@@.@@@@@@@@@@@@@..@@@@@@.@@@@@.@@.@@@@@@@@.@.@@.@@@@@.@@.@.@@@@@@@.@@@@@@.@.@@.@.@@@.@
@@@@@...@@.@.@.@.@@@.@.@@@@.@..@....@@@@@@@.@...@@.@@..@@@..@@.@@@....@@@@@.@@.@.@..@..@@@.@@...@.@@@@@@.@@@@@@@..@...@.@.@.@.@@..@.@@@@@..
....@@@@.@.@@..@@.@@.@@.@@@@@..@@.@.@@.@@@..@@.@.@@...@.@.@.@@.@@@@@@.@@@@@.@.@.@..@@@@@@.@@@.@@@.@.@@@@..@..@@.@@@..@@@@..@.@@@@@@@@@@.@@.
..@@.@@@@.@.@@@..@@...@@@@@@@.@..@@.@.@.@@@@@@.@@.@@@.@@.@@@@@..@.@@@...@@@@@.@@.@@.@@..@@@@@@...@@..@@...@@@@@@@@@@@@.@@.@@@@@@.@@.@@@@..@
@@@..@@.@@@@@...@...@@@@@.@@...@.@@@@..@@.@.@.@.@@.@@@@@@@..@@@@.@@@@.@@@@@..@@.@.@.@.@@@.@..@.@@@@@@@@@@.@.@.@@@@@@@@@.@@@@@.@@.@.@@@.@.@.
@@@.@@..@...@@.@.@@@.@@.@@@@.@@@@@...@@..@@@@.@..@@.@@@@..@@@.@.@.@..@@.@@@@@@.@.@@@.@@.@@@@@.@@@@@@@@.@...@@.@@@@.@.@@@.@@@@..@@@@@.@@..@@
@@...@@.@.@@.@@@.@..@.@@@@@.@.@@@.@@@@@@.@@.@.@@@@@.@@@@@.@@@@@@.@@@@....@..@....@@@..@.@.@@@@@.@@@@@@@@@@@.@@@@@@@@.@@.@@..@..@@@@@..@..@@
@..@@@.@.@.@@.@@@.@@@@@.@@@.@@@@.@@.@.@@.@@@@@@@.@@@...@@.@@@@@@.@@@.@..@@@@@@.@@....@.@@@@@@@..@..@@.@@@.@@@@@.@@@@.@@@@@.@.@@@.@.@.@.@.@.
@@@.@@..@@@@.@.@..@@.@@..@@..@@.@.@@.@.@@.@..@@@.@@@@.@..@.@..@@@@@@@.@@@@@@@@@@..@@@.@@.@@..@.@..@.@@@@@@@.@@@.@.@@@.@.....@.@..@@@@@@...@
@..@.@..@@@@@...@@...@..@@..@@.@..@@@@.@..@@..@@@@..@@@.@@...@.@@@@@@@@....@@@.@@@@@@@@@@@@@.....@@..@@@@@@@@@@.@@@@@@@@.@@@@@@...@@..@@@@.
@.@@.@.@.@.@..@@@.@@...@@@..@.@@.@@@@@......@@@@@.@@.@@@@@@..@@...@...@..@@.@@.@@..@@.@@.@@.@@.@@@@@@.@@@..@@.@@@@@@@@@.@.@.@@@@.@@@@@@.@@@
..@@@@@@.@...@..@@@@@@@@@.@@@@@...@@@@@@@@@@@@.@.@@..@.@@@....@@@.@..@@@@@@@@@@.@@.@@@@.@.@@.@.@@@@@@.@@@@..@.@@@..@@@@.@@@@@@@@@..@@@@@.@@
@@@@@@.@@@.@@.@..@@.@..@.@.@.@@.@@@@@@...@..@@.@.@@@@.@.@@@..@.@@..@.@@@...@@@...@.@.@@.....@@.@..@@@@.@@..@@.@@@@@@@..@.....@@@.@.@@@@..@@
.@@....@.@.....@.@@@@....@@@..@...@@@@@@.@@@@.@@@.@@.@@@..@@.@@@.@.@...@@@.@.@@.@.@.@@@..@@@@@.@@@@@@@@@.@@.@.@@.@.@@.@@..@.@@@@.@@@@@@@@@@
@.@@@@@@@.@@@@@.@..@@@@@@.....@..@@@@@.@@@.@@@.@@@@.@..@@.@@@..@@@.@@@@@.@@@@@@.@@..@@.@..@@@@@@@@@@@@.@@.@@.@@@..@@.@@@@..@@.@@@@@@@@@.@..
@@.@@.@.@@@@..@@@@.@@@@@@@@...@@@@..@@..@.@@.@@@@@@@@.@.@@@@.@@@..@@@@@@.@@@@@.@@.@@.@....@@@@@@..@@@@.@@@@.....@@...@@.@@.@@@.@@@@.@@@.@.@
.@@@.@@@@@@.@.@.@@@.@.@.@..@@.@.@@@.@@@@@@@@@..@@.@.@@@@@@@@.@.@.@.@@.@@..@@...@.@@@@@@@.@.@@.@.@@.@..@@@..@@.@.@@@.@@..@@@@@@@@.@@@@@.@@@@
.@@.@@@.@@@.@@@..@@.@@..@@..@@@.@.@@....@@..@..@@@@@@@@@@@.@@@.@.@@@@..@@.@.@@@@@@@@@..@.@.@@@@@@...@@@@.@..@@.@.@.@@@@@.@..@@@@@@..@...@@@
.@@@@.@@@@@@@@.@@.@@@@@..@@@@.@.@@@...@@@.@@@..@@@@@@@@.@.@@@.@@.@@@.@@@@@@@@@.@..@.@.@@..@@@@...@@..@@.@..@.@@@@..@@@@@@..@@@....@.@@@@.@@
.@@.@..@.@..@.@@@@@@@@.@@@@@@@@@@..@@...@..@@.@@.@@@.@..@..@@.@@@@@@.@.@.@@.@@@.@@...@@@@@@@@@..@@@@@...@.@@@@..@@@.@.@.@.@@@@..@@@@@.@@..@
@@@.@@@.@.@@.@@@@.@.@@@.@@@@@@.@@@@.....@@@@@..@@@...@.@@@..@@@@.@@..@@@.@@@..@@@@..@@.@@.@..@@.@@..@.@@@@@.@@@@.@@....@@@@@@@@.@@@@@.@.@..
@@...@@@@@@@@@@@@@..@.@@@..@@@@@@@@@@.@@.@..@.@@@@...@.@..@@@.@@.@.@.@@@@@@@.@..@@.@@..@@@@@@@@@@@.@.@@@@@.@@@@@.@@@@..@@..@.@@@@.@@@@@...@
.@@@@.@..@@@.@@@.@@@@...@@@.@@@....@@.@@@@@@@..@.@.....@.@@@...@@@@@@@..@@@.@.@@@@.@..@@@.@.@.@@@@@@@..@@@@@..@.@@@@.@@@@@.@.@@.@@.@@@@.@..
@@@..@@@@.@@@@..@@..@@@@@..@.@.@.@...@.@@.@@@..@@.@.@@@@@@@.@@@@...@@..@@..@@@.@..@@@.@.@@@@.@.@@@@@@@@.....@@.@@@@@..@@@@@@....@@@.@@@@@@.
@@.@@@@@@@@@..@@@.@.@.@..@..@.@..@@@..@@..@.@@@@.@@@@@@@@@@@@@@@.@..@@@@@@@@@@@@.@@@@.@@...@@@.@@.@@.@@@@@@.@@@@..@...@.@@@@@.@.@.@@@@@@@@.
.@.@@@.@@.@@..@@.@.@...@.@.@@..@..@@@..@@@@.@@@..@@@..@.@.@.@.@@@@@@@@@@....@@.@@@@.@@@@@@..@@@..@@@.@@@@..@..@@@.@@@@@@@.@.@.@@@@@@@@...@.
.@....@.@.@@@@@.@@@@.@@@.@..@...@@@.@@.@@..@.@@@@@@@@.@.@.@@.@.@@..@@..@.@...@@@@@.@@@@@..@@.@@@.@@@@..@@.@@@@@@.@....@@@@@@@@@@@.....@@.@@
@..@@.@@@@@@@@@.@@@.@..@@@@.@@@@@.@.@@.@.@@@@@..@@@.@@.@@@..@.@.@@@...@.@.@@@..@@@@@@@@@..@.@@@@.@@.@@@@@@@@..@@.@.@@@....@@@@@@..@.@...@@@
.@@@@@..@@@.@..@@@.@@@.@.@@.@@.@@.@...@.@.@@..@@@@@@@...@@..@@@@@@@.@@@..@..@.@@@..@@@@@@.@@@@..@.@@@@@@@@@@@@.@.@@.@@@.@@@.@@.@.@.@.@.@@@.
@@@@@..@...@@@...@@@.@.@@@@...@..@@@@@@@@..@@...@.@.@@@@@.@@@@.@@@.@@@@@..@@@...@.@@@@@@@@.@@.@@@...@@@@@@.@@@@@.@@@@@@@.@@.@.@@.@@@..@@@@@
@..@.@@.@@@@@.@@.@@...@@@.@@@....@...@..@..@.@@@@.@@@@@@@@@.@.@@@@@@@@..@@@@@@..@..@.@@..@@@.@@...@.@.@.@..@@..@@@@.@.@.@..@@.@@.@.@@@@@@@@
@@.@.@.@@@@....@.@@@@.@@@..@.@@@.@.@@.@@..@@.@@@.@...@.@@@@@@@@@..@..@@@@@@@.@...@@@..@@@..@..@@..@@@@@@...@.@@.@@@@@..@@@@@@.@@@@@.@@@@@@.
@@..@@@@@@.@..@.@.@@@@.@@@@@.@@@.@@@@@@@.@@@@@....@@.@@..@@@@@@@@@...@.@@@.@@@.@@.@@@@.@..@.@.@.@@@@@.@@@@...@.@@@@@@.@.@@.@@@@@..@@@@@.@@@
.@..@@@.@..@.@.@...@@@@@.@@@@.@@@@@@@@@@@.@@.@@@@@.@@.@@.@@@.@@@.@...@.@@@@@@@.@.@@@@.@@@@@@@@@@@@...@@@@.@@.@@@@@@@.@@.@@@.@.@@.@@@.@@@@@@
@@@@.@@@@.@@@@@@@@@@.@@@@@...@.@@@@@.@@@@@@@@@.@@@..@...@@...@@@.@..@@@..@.@@.@@@@.@@@@.@@@@@@@@@.@@@@@@.@@@.@.@@@.@@.@.@..@@@@.@..@@@..@@@
....@..@@.@.@...@@@@@@..@@.@@.@@..@@@..@@..@@.@..@@@@.@@@.@@@@@.@@.@@..@..@@..@@@@@..@.@@@@@@@@..@.@@..@@@@..@@@@..@@...@...@.@..@@@@@@@@..
@@..@@@@.@@.....@.@@@@..@.@@..@@@.@@@@@@@@@@@@@@.@@@@.@@@@.@@.@@.@@@@@.@@.@..@@.@......@@@.@@@..@@@@@@@@@@.@.@@...@@@@@@@@.@.@@.@@@@@.@@@@.
@@@..@.@@.@@@@.....@@@.@.@@@.@@@.@....@@@@.@.@.@@@..@@@.@@.@@@.@@.@.@@..@@@@@.@.@@..@.@.@...@@@.@.@.@@@@.@@.@@@.@@..@..@@@.@.@@.@@..@..@@@.
..@@.@@@@@@@@.@.@@..@..@@@..@..@@@..@.....@@@@..@@@.@@.@@@.@@@....@@.@.@@....@@@@@@.@@@.@@@.@@@.@@@.@@@@@@@.@@....@@@@..@.@....@@@@.@..@@@@
@..@.@@.@@.@.@@@.....@.@@@@.@.@@.@@..@@@@.@..@@@@@@.@@@@@.@@@@..@@@@@@@@@@@@@.@.@.@@@.@.@@@@@@@@.@.@@@@.@@@.@@@@@.@@@@@@..@@@@@..@.@.@@@@@@
@@@@@..@@@..@@@@@@.@@@.@.@.@@@..@@@@@@@.@@....@@@@@@@..@@..@..@@.@@@@@.@.@@@....@@@@@@.....@....@@.@@@@.@@@.@@@@.@@@@.@@@@@@..@@.@@...@@@.@
.@....@@.@.@..@.@.@@@@@@@@@.@@.@@@.@...@.....@@.@@...@@@@@@@..@.@@@@@.@@.@@@@@@@.@@..@.@@@.@.@@@.@@@@@@.@@..@@@.@@..@@@.@@@.@.@@...@@@@..@.
@..@@@@@@@@.@@@.@@@@.@..@.@@@.@@@@..@@.@@@@.@@.@@@.@@@@@@@@.@@@..@@..@@@@@.@@.@.@@.@.@@@.@@@.@@.@.@@@@....@@@..@.@@.@.@.@@@.@@@@@@@@@.@@@@@
.@@@.@@@.@@@@.@.@@@@@@@.@.@@@@@@@.@@@@@@.@@.@@@.@@.@.@.@@@@@@...@@@@@.@@@@....@.@@@@@..@.@@@@@@@@@.@.@@.@.@@...@.@.....@@.@@@@@@@..@@@.@.@.
@@@@..@@@.@@@.@@@@@@@@@.@@.@@..@.@@.@@...@@.@@@.@@.@@..@@..@@@@.@@.@@@@@@@@@.@.@@@@@@.@@@@..@..@@..@@@.@@.@@@@@@.@@@@.@.@.@@@@@@@@@....@@.@
@@@.@@@@@@.@@....@@@@@@@@@@@@@@.@@@@@@.@@@@.@.@.@@@@.@@@..@@.@@...@@@@@.@@@@@..@....@@@....@@.@@.@...@.@@@.@@...@@.@@@@.@@@@.@..@.@@@@@@@..
@@@.@@..@..@.@@@@.@@@@@@@.@@@@@.@..@@.@@@@.@@@@.@.@@.@.@@@.@@@..@@@..@@@@...@@.@@@@.@@@@@..@.@@@@@@.@@@.......@@@@.@@@@@..@@..@@@@@..@@@@@@
@@.@@@@..@.@..@..@.@.@.@.@@@@@...@.@.@.@.@....@.@@.@@@.@.@@@@@@...@.@@@.@@@@@@@.@@@.@@@@.@....@@@.@.@@.@.@@@@@..@@@@@@....@@@..@@.@....@@@@
@@.@@@@@@.@@.@@@.@.@@@.@..@@@..@@.@@.@@..@@@.@@@.@@..@@@@@@@.@@.@.@..@@@@@@@@.@@@@@...@@.@@@..@.@@@@@@.@@@...@.@.@.@@@..@.@@...@@@@..@@@@@.
.@.@.@..@@@@@@@@.@.@@..@..@@..@@@.@.@.@@.@@.@@@@@@..@.@@.@..@.@@@.@.@@@.@@@@@.@.@@@@.@.@@...@.@@@..@@@@..@.@@@.@.@.@@..@@@@@@.@@@@..@.@@@@@
.@@.@.@@@@@@.@..@@@@@@.@@@@.@.....@@@@@@.@@..@.@@@..@@..@@@@.@.@.@@.@..@.@@@@.@@@@@.@@..@@@.@..@...@@@@@@@..@@.@@@.@@@@@.@@.@.@@@@@.@@@@..@
..@.@..@@.@@.@@@@@@@..@.@...@..@@@...@@@.@@@@....@@@@....@@@@@@@.@.@@.@@@@@@.@@.@@...@@@@..@.@..@.@@@@@.@@..@@@.@@@@..@@@.@@@@..@@.@.@..@@.
@.@@@@@@@@@.@@@@..@.@.@@@@..@@..@@@@.@@@@@..@@...@@@@..@.@....@.@@.@.@@.@.@.@.@@@@@@.@@.@....@.@.@..@@@.@..@@@@.@@@@@.@.@.@@@.@.@.@.@..@@@@
@.@@@@.@...@@@.@@..@.@@.@@@...@..@@.@@@@@@@@.@@@@@.@.@..@..@.@@@.@...@@@.@@..@.@..@.@@@...@@@@@@@@@@@@..@@@@@@..@@@..@@@.@.@@@..@@@@@.@.@@@
.@@@@@@.@....@.@..@@@@@.@.@@.@@@.@@@@..@.@.@.@.@.@...@.@@.@@@@..@@@@@.@@.@..@@@@@@.@.@@@@@@@@@@@.@..@.@@..@.@@@@@@.@@@.@@.@@@@@.@.@..@.@@..
@@.@@@.@.@@@@@..@.@@@@@@.@@.@.@@@..@@@@@@@.@@@@..@@@@@.@..@.@.@..@.@@@@@.@.@@.@.@@@@@@@...@..@.@.@@..@@..@@@@@.@.@@@@.@@..@@@...@.@.@.@@.@@
@@@@@@@@.@..@.@@.@..@@@....@....@..@@@.@@@@.@@@..@@@@@@@..@.@@@@@.@.@@..@@@..@@.@@@@.@.@@@.@@.@@@@@@..@.@@.@..@.@@.@@.@@@@.@...@@@@....@@.@
.@@@@@..@....@@@@...@@@.@.@.@@@@.@@..@.@@..@@@@..@.@@@@@@@@@.@..@.@@@@.@@@@@.@@@.@.@@@..@@...@.@.@..@@@.@@.@..@@.@@@.@@.@@.@@@@.@@..@@@@@@.
.@@@..@@@@@@@....@@@@.@@@@@.@@@@@@@.@@@@@.@@.@@@@.@.@.@@.@@@@..@@.@......@@@@.@@@@....@@.@@@.@.@@.@@@@@@.@@@@@.@.@@...@@.@@.@...@@@..@@@@..
";

static TESTINPUT: &str = "
..@@.@@@@.
@@@.@.@.@@
@@@@@.@.@@
@.@@@@..@.
@@.@@@@.@@
.@@@@@@@.@
.@.@.@.@@@
@.@@@.@@@@
.@@@@@@@@.
@.@.@@@.@.
";

static VERBOSE: bool = false;

fn main() {
    println!("********************");
    println!("ADVENT 2025 DAY 4");
    println!("********************");

    let mut input: &str;
    let mut args = std::env::args();
    if args.any(|a| return a == "--test") {
        println!("using test data");
        input = TESTINPUT;
    } else {
        input = INPUT;
    }
    input = input.trim();

    part1(input);
    part2(String::from(input));
}

fn part1(input: &str) {
    let width: i32 = input.lines().nth(0).unwrap().len() as i32;
    let height = input.lines().count() as i32;

    let start_time = std::time::Instant::now();

    let mut answer = 0;
    let mut y = 0;
    for l in input.lines() {
        if l == "" {
            continue;
        }
        let mut x = 0;
        for c in l.chars() {
            if c != '@' {
                x += 1;
                continue;
            }
            let n_neighbors = test_elem(x, y, width, height, input);
            if VERBOSE {
                println!("({}, {}) has {} positive neighbors", x, y, n_neighbors)
            }
            if n_neighbors < 4 {
                if VERBOSE {
                    println!("({}, {}) valid for removal", x, y);
                }
                answer += 1;
            }
            x += 1;
        }
        y += 1;
    }

    let elapsed = start_time.elapsed();
    println!("------------ PART 1 -----------------");
    println!("Anwser is \n{}\n", answer);
    println!("processing time {}us", elapsed.as_micros());
    println!("-------------------------------------");
}

fn part2(mut input: String) {
    let width: i32 = input.lines().nth(0).unwrap().len() as i32;
    let height = input.lines().count() as i32;
    let byte_stride = width + 1; // plus newline

    let start_time = std::time::Instant::now();

    let mut answer = 0;
    let mut to_remove_c = 1;

    while to_remove_c > 0 {
        let mut y = 0;
        let mut to_remove: Vec<usize> = Vec::new();

        for l in input.lines() {
            let mut x = 0;
            for c in l.chars() {
                if c != '@' {
                    x += 1;
                    continue;
                }
                let n_neighbors = test_elem(x, y, width, height, input.as_str());
                if VERBOSE {
                    println!("({}, {}) has {} positive neighbors", x, y, n_neighbors)
                }
                if n_neighbors < 4 {
                    if VERBOSE {
                        println!("({}, {}) valid for removal", x, y);
                    }
                    let pos = (y * byte_stride + x) as usize;
                    to_remove.push(pos);
                }
                x += 1;
            }
            y += 1;
        }
        to_remove_c = to_remove.len();
        answer += to_remove.len();

        let bytes = unsafe { input.as_bytes_mut() };
        for pos in &to_remove {
            bytes[*pos] = b'.';
        }
        to_remove.clear();
    }

    let elapsed = start_time.elapsed();
    println!("------------ PART 2 -----------------");
    println!("Anwser is \n{}\n", answer);
    println!("processing time {}us", elapsed.as_micros());
    println!("-------------------------------------");
}

// test all 8 adjacent positions without overflowing
// x x x
// x o x
// x x x
// Returns the count of matching neighbors
fn test_elem(x: i32, y: i32, width: i32, height: i32, input: &str) -> i32 {
    // (delta x, delta y)
    let tests: [(i32, i32); 8] = [
        (-1, -1),
        (0, -1),
        (1, -1),
        (-1, 0),
        (1, 0),
        (-1, 1),
        (0, 1),
        (1, 1),
    ];
    let mut c = 0;
    for t in tests {
        let target_x = x + t.0;
        let target_y = y + t.1;
        if target_x < 0 || target_x > width - 1 {
            continue;
        }
        if target_y < 0 || target_y > height - 1 {
            continue;
        }
        let neighbor = input
            .lines()
            .nth(target_y as usize)
            .unwrap()
            .chars()
            .nth(target_x as usize)
            .unwrap();
        if neighbor == '@' {
            c += 1;
        }
    }
    return c;
}

fn test_elem_bytes(x: i32, y: i32, width: i32, height: i32, input: &[u8]) -> i32 {
    // (delta x, delta y)
    let tests: [(i32, i32); 8] = [
        (-1, -1),
        (0, -1),
        (1, -1),
        (-1, 0),
        (1, 0),
        (-1, 1),
        (0, 1),
        (1, 1),
    ];
    let mut c = 0;
    for t in tests {
        let target_x = x + t.0;
        let target_y = y + t.1;
        if target_x < 0 || target_x > width - 1 {
            continue;
        }
        if target_y < 0 || target_y > height - 1 {
            continue;
        }
        let pos = (y * (width + -1) + x) as usize;
        let neighbor = input[pos];
        if neighbor == b'@' {
            c += 1;
        }
    }
    return c;
}
